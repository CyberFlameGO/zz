using <string.h>::{memcmp, strlen};
using <stdio.h>::{printf};
using hex;




fn t(char *str, u8 *expect, usize expect_size) -> int {
    u8 mut out[1024];
    out[0] = 0;


    usize slen = as<usize>(strlen(str));
    static_attest(len(str) == slen);
    usize count = hex::str2bin(str, slen, out, 1024);

    printf("%x %x %d<>%d\n", out[0], out[1], count, expect_size);

    if count != expect_size {
        return 1;
    }

    return memcmp(expect, out, count);
}

pub fn main() -> int {

    {
        u8 expect[] = {0x76};
        if t("76", expect, static(len(expect))) != 0 {
            return 1;
        }
    }

    {
        u8 expect[] = {0x76};
        if t("761", expect, static(len(expect))) != 0 {
            return 2;
        }
    }

    {
        u8 expect[] = {0x76, 0x12};
        if t("7612", expect, static(len(expect))) != 0 {
            return 3;
        }
    }

    {
        u8 expect[0];
        if t("", expect, 0) != 0 {
            return 4;
        }
    }

    return 0;
}
